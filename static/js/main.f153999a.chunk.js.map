{"version":3,"sources":["../../src/PlotlyPlot.js","../../src/utils.js","../../src/index.js","App.js","index.js"],"names":["Plotly","require","sumOfArray","arr","c","averageOfArray","Plot","createPlotlyComponent","Weibull","scale","name","rest","useState","wb","x","y","f","lg","useEffect","data","p","i","e","Math","n","length","weibullDistribution","ys","xs","xMean","yMean","Number","dividend","divisor","slope","intercept","result","y_to_yMean","y_linear_to_yMean","r","error","linearRegression","setPlotData","plotData","type","mode","text","hovertemplate","hoverinfo","marker","size","layout","showlegend","yaxis","tickmode","tickvals","ticktext","config","responsive","App","ReactDOM","render","document","getElementById"],"mappings":"mVAAMA,EAASC,EAAf,KACAD,WAAgB,CAACC,EAAjBD,OCDO,IAAME,EAAcC,YAAD,OAASA,UAAW,qBAAUC,EAArBD,IAA5B,IAEME,EAAkBF,YAAD,OAASD,KAAkBC,EAAlD,QCIDG,EAAOC,IAAb,GAEaC,EAAU,SAAC,GAOlB,IDqCuBC,EC5CL,EAOlB,EAPkB,KAOlB,IALJC,YAKI,MAPkB,GAOlB,MAJJD,aAII,MAJI,CAAC,KAAD,sCAHc,KAOlB,EADDE,EACC,iBACJ,EAAgCC,mBAAS,CACvCC,GAAI,CAAEC,EAAF,GAASC,EAAT,GAAgBC,EAAG,IACvBC,GAAI,CAAEH,EAAF,GAASC,EAAG,MAFlB,mBAAM,EAAN,KAAM,EAAN,KAiBA,OAZAG,qBAAU,WACR,GAAI,OAACC,QAAD,IAACA,KAAL,QAOA,IAAMN,EDW0BV,YAClC,GAAI,OAACA,QAAD,IAACA,MAAL,OACE,YAEFA,QAAS,qBAAWiB,OAApBjB,KACA,IAAMa,EAAIb,OAAQ,qBAAWkB,EAAD,IAAYlB,EAAxC,UAIA,MAAO,CAAEW,EAHCX,OAASmB,YAAD,OAAOC,SAAzB,MAGeR,EAFLC,OAAOM,YAAD,OAAOC,SAASA,SAAS,GAAK,EAA9C,QAEqBP,EAAd,EAAoBQ,EAAGrB,EAAIsB,QCpBrBC,CAAX,GACMT,ED1BsB,SAACH,EAAGa,GAClC,IAAIC,EAAJ,EACA,IACEA,KACAD,WAAW,cACTC,OAAQP,EAARO,OAOJ,IAJA,IAAMC,EAAQxB,EAAd,GACMyB,EAAQzB,EAAesB,UAAWL,YAAD,OAAQS,aAA/C,OACIC,EAAJ,EACIC,EAAJ,EACSZ,EAAT,EAAgBA,EAAIO,EAApB,WACEI,IAAaJ,KAAD,IAAmBD,KAA/BK,GACAC,IAAYL,KAAD,IAAmBA,KAA9BK,GAEF,IAAMC,EAAQF,EAAd,EACMG,EAAYL,EAAQD,EAA1B,EACMO,EAAN,GACAR,WAAYN,YACVc,OAAYd,IAAZc,MAEF,IAAMC,EAAaV,OAAQL,YAAD,OAAQA,EAAD,IAAeA,EAAhD,MACMgB,EAAoBF,OAAYd,YAAD,OAAQA,EAAD,IAAeA,EAA3D,MACMiB,EAAIrC,KAAgCA,EAA1C,GACMsB,EAAID,SAASA,KAATA,GAAmB,EAAF,EAA3B,GACA,MAAO,CACLW,MADK,EAELnB,EAFK,EAGLD,EAHK,EAIL0B,MAJK,EAKLL,UALK,EAMLX,EAAGA,GCNQiB,CAAiB5B,EAAD,EAAOA,EAAlC,GACA6B,EAAY,CAAE7B,GAAF,EAAUI,GAAIA,SARxByB,EAAY,CACV7B,GAAI,CAAEC,EAAF,GAASC,EAAT,GAAgBC,EAAG,IACvBC,GAAI,CAAEH,EAAF,GAASC,EAAG,QAOnB,CAXHG,IAaE,qBACEC,KAAM,CAAC,2BAEAwB,EADL,IADI,IAGFC,KAFF,UAGEC,KAHF,UAIEnC,KAJF,EAKEoC,KAAMH,YAAmBrB,YAAD,iBAAW,IAAD,WALpC,GAK0B,QACxByB,cAAe,0BAPb,2BAUCJ,EADL,IATI,IAWFK,UAFF,OAGEtC,KAHF,oBAIEuC,OAAQ,CACNC,KAAM,MAIZC,OAAM,aACJC,YADM,EAENC,MAAO,aACLC,SADK,UDHc7C,ECKH,EDFjB,CAAE8C,SAFG9C,OAAWa,YAAD,OAAOC,SAASA,SAAS,GAAK,EAApD,QAEwBiC,SADX/C,OAAWa,YAAD,gBAAvB,IAAiCA,EAAV,YCKdX,GAEL8C,OAAQ,CACNC,YAAY,MCrDLC,G,OAJH,WACV,OAAO,kBAAC,EAAD,QCATC,IAASC,OAAO,kBAAC,EAAD,MAASC,SAASC,eAAe,W","file":"static/js/main.f153999a.chunk.js","sourcesContent":["const Plotly = require('plotly.js/lib/core')\r\nPlotly.register([require('plotly.js/lib/scattergeo')])\r\n\r\nexport default Plotly\r\n","export const sumOfArray = (arr) => arr.reduce((c, n) => c + n, 0)\r\n\r\nexport const averageOfArray = (arr) => sumOfArray(arr) / arr.length\r\n\r\nexport const linearRegression = (x, ys) => {\r\n  let xs = x\r\n  if (!xs) {\r\n    xs = []\r\n    ys.forEach((e, i) => {\r\n      xs.push(i + 1)\r\n    })\r\n  }\r\n  const xMean = averageOfArray(xs)\r\n  const yMean = averageOfArray(ys.filter((e) => !Number.isNaN(e)))\r\n  let dividend = 0\r\n  let divisor = 0\r\n  for (let i = 0; i < xs.length; ++i) {\r\n    dividend += (xs[i] - xMean) * (ys[i] - yMean)\r\n    divisor += (xs[i] - xMean) * (xs[i] - xMean)\r\n  }\r\n  const slope = dividend / divisor\r\n  const intercept = yMean - xMean * slope\r\n  const result = []\r\n  xs.forEach((e) => {\r\n    result.push(e * slope + intercept)\r\n  })\r\n  const y_to_yMean = ys.map((e) => (e - yMean) * (e - yMean))\r\n  const y_linear_to_yMean = result.map((e) => (e - yMean) * (e - yMean))\r\n  const r = sumOfArray(y_linear_to_yMean) / sumOfArray(y_to_yMean)\r\n  const n = Math.pow(Math.E, (-1 * intercept) / slope)\r\n  return {\r\n    slope: slope,\r\n    y: result,\r\n    x: xs,\r\n    error: r,\r\n    intercept: intercept,\r\n    n: n\r\n  }\r\n}\r\n\r\nexport const weibullDistribution = (arr) => {\r\n  if (!arr?.length) {\r\n    return null\r\n  }\r\n  arr.sort((p, n) => (p > n ? 1 : -1))\r\n  const f = arr.map((e, i) => (i + 0.5) / arr.length)\r\n  const x = arr.map((e) => Math.log(e))\r\n  const y = f.map((e) => Math.log(Math.log(1 / (1 - e))))\r\n\r\n  return { x: x, y: y, f: f, n: arr.length }\r\n}\r\n\r\nexport const weibullScale = (scale) => {\r\n  const val = scale.map((e) => Math.log(Math.log(1 / (1 - e))))\r\n  const text = scale.map((e) => `${e * 100}%`)\r\n  return { tickvals: val, ticktext: text }\r\n}\r\n","import React, { useState, useEffect } from 'react'\nimport Plotly from './PlotlyPlot'\nimport createPlotlyComponent from 'react-plotly.js/factory'\n\nimport { weibullDistribution, weibullScale, linearRegression } from './utils'\n\nconst Plot = createPlotlyComponent(Plotly)\n\nexport const Weibull = ({\n  data,\n  name = '',\n  scale = [\n    0.0001, 0.005, 0.01, 0.05, 0.1, 0.2, 0.5, 0.6, 0.7, 0.8, 0.9, 0.95, 0.99\n  ],\n  ...rest\n}) => {\n  const [plotData, setPlotData] = useState({\n    wb: { x: [], y: [], f: [] },\n    lg: { x: [], y: [] }\n  })\n\n  useEffect(() => {\n    if (!data?.length) {\n      setPlotData({\n        wb: { x: [], y: [], f: [] },\n        lg: { x: [], y: [] }\n      })\n      return\n    }\n    const wb = weibullDistribution(data)\n    const lg = linearRegression(wb.x, wb.y)\n    setPlotData({ wb: wb, lg: lg })\n  }, [data])\n  return (\n    <Plot\n      data={[\n        {\n          ...plotData.wb,\n          type: 'scatter',\n          mode: 'markers',\n          name: name,\n          text: plotData.wb.f.map((e) => `${(100 * e).toFixed(2)}%`),\n          hovertemplate: 'y: %{text}' + '<br>x: %{x}'\n        },\n        {\n          ...plotData.lg,\n          hoverinfo: 'none',\n          name: 'linear regression',\n          marker: {\n            size: 1\n          }\n        }\n      ]}\n      layout={{\n        showlegend: false,\n        yaxis: {\n          tickmode: 'array',\n          ...weibullScale(scale)\n        },\n        ...rest\n      }}\n      config={{\n        responsive: true\n      }}\n    />\n  )\n}\n","import React from 'react'\n\nimport { Weibull } from 'react-weibull'\nimport 'react-weibull/dist/index.css'\n\nconst App = () => {\n  return <Weibull />\n}\n\nexport default App\n","import './index.css'\n\nimport React from 'react'\nimport ReactDOM from 'react-dom'\nimport App from './App'\n\nReactDOM.render(<App />, document.getElementById('root'))\n"],"sourceRoot":""}